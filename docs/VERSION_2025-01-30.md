# Palpiteiro MVP - VersÃ£o 30/01/2025

## VisÃ£o Geral

Palpiteiro Ã© um aplicativo de anÃ¡lise de sentimento para rumores de transferÃªncias do futebol brasileiro. O foco Ã© capturar o sentimento da torcida sobre rumores, nÃ£o apostas.

**Filosofia**: "NÃ£o Ã© um site de aposta, Ã© um site de sentiment analysis"

---

## Funcionalidades Implementadas

### 1. Sistema de ReaÃ§Ãµes (Slack-style)

SubstituÃ­mos o sistema binÃ¡rio "vai/nÃ£o vai" por reaÃ§Ãµes estilo Slack:

| Emoji | Label | Sentimento |
|-------|-------|------------|
| ğŸ”¥ | Quero muito | 1.0 |
| ğŸ‘ | Seria bom | 0.75 |
| ğŸ˜ | Tanto faz | 0.5 |
| ğŸ˜• | NÃ£o curti | 0.25 |
| ğŸ’” | NÃ£o quero | 0.0 |

**Arquivos**:
- `/app/components/ReactionPicker.tsx`
- `/app/api/reactions/route.ts`

### 2. PÃ¡gina de Detalhes do Rumor

Quando o usuÃ¡rio clica em um rumor, vÃª:
- InformaÃ§Ãµes do rumor (tÃ­tulo, descriÃ§Ã£o, categoria)
- Barra de sentimento visual
- Tabs com conteÃºdo:
  - ğŸ“° NotÃ­cias (Globo, UOL)
  - ğŸ¦ Twitter (tweets de influenciadores e torcedores)
  - â–¶ï¸ YouTube (vÃ­deos relacionados)
- Aviso se nÃ£o houver fontes confirmando o rumor

**Arquivos**:
- `/app/rumor/[id]/page.tsx` - Server component
- `/app/rumor/[id]/RumorDetailContent.tsx` - Client component

### 3. Escudos Reais dos Times

Todos os Ã­cones de times agora usam escudos reais via API do SofaScore.

**Arquivo centralizado**: `/lib/teams.ts`

```typescript
export const TEAMS: Team[] = [
  {
    id: 'flamengo',
    name: 'Flamengo',
    shortName: 'FLA',
    color: '#E11D48',
    logo: 'https://api.sofascore.app/api/v1/team/5981/image',
  },
  // ... 16 times do BrasileirÃ£o
]
```

**Componentes**:
- `/app/components/TeamLogo.tsx` - `TeamLogo` e `TeamButton`

**Arquivos atualizados**:
- `/app/feed/FeedClient.tsx`
- `/app/onboarding/page.tsx`
- `/app/components/SmartSearch.tsx`
- `/app/time/[teamId]/page.tsx`
- `/app/time/[teamId]/TeamPageClient.tsx`

### 4. Algoritmo de RelevÃ¢ncia para Feed

O feed agora ordena rumores por relevÃ¢ncia personalizada.

**Fatores (100 pontos total)**:

| Fator | Peso | DescriÃ§Ã£o |
|-------|------|-----------|
| Meu Time | 40 | Rumores sobre o time do usuÃ¡rio |
| Engajamento | 20 | Rumores que o usuÃ¡rio jÃ¡ interagiu |
| Buzz | 25 | Predictions + Signals + News |
| RecÃªncia | 10 | Rumores mais novos |
| UrgÃªncia | 5 | Proximidade do fechamento |

**Arquivos**:
- `/lib/relevance.ts` - MÃ³dulo com funÃ§Ãµes de cÃ¡lculo
- `/app/feed/page.tsx` - ImplementaÃ§Ã£o no server
- `/app/api/rumors/route.ts` - API com suporte a relevÃ¢ncia
- `/app/api/rumors/relevance/route.ts` - Endpoint dedicado

---

## Estrutura de Arquivos

```
palpiteiro-mvp/
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ api/
â”‚   â”‚   â”œâ”€â”€ reactions/route.ts
â”‚   â”‚   â”œâ”€â”€ rumors/
â”‚   â”‚   â”‚   â”œâ”€â”€ route.ts
â”‚   â”‚   â”‚   â””â”€â”€ relevance/route.ts
â”‚   â”‚   â”œâ”€â”€ vote/route.ts
â”‚   â”‚   â””â”€â”€ news/
â”‚   â”‚       â”œâ”€â”€ rumor/route.ts
â”‚   â”‚       â””â”€â”€ signals/route.ts
â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â”œâ”€â”€ ReactionPicker.tsx
â”‚   â”‚   â”œâ”€â”€ RumorCard.tsx
â”‚   â”‚   â”œâ”€â”€ TeamLogo.tsx
â”‚   â”‚   â”œâ”€â”€ SmartSearch.tsx
â”‚   â”‚   â””â”€â”€ ...
â”‚   â”œâ”€â”€ feed/
â”‚   â”‚   â”œâ”€â”€ page.tsx
â”‚   â”‚   â””â”€â”€ FeedClient.tsx
â”‚   â”œâ”€â”€ rumor/
â”‚   â”‚   â””â”€â”€ [id]/
â”‚   â”‚       â”œâ”€â”€ page.tsx
â”‚   â”‚       â””â”€â”€ RumorDetailContent.tsx
â”‚   â”œâ”€â”€ time/
â”‚   â”‚   â””â”€â”€ [teamId]/
â”‚   â”‚       â”œâ”€â”€ page.tsx
â”‚   â”‚       â””â”€â”€ TeamPageClient.tsx
â”‚   â””â”€â”€ onboarding/
â”‚       â””â”€â”€ page.tsx
â”œâ”€â”€ lib/
â”‚   â”œâ”€â”€ teams.ts
â”‚   â”œâ”€â”€ relevance.ts
â”‚   â””â”€â”€ prisma.ts
â””â”€â”€ prisma/
    â””â”€â”€ schema.prisma
```

---

## Schema do Banco de Dados

### Modelos Principais

```prisma
model User {
  id          String       @id @default(cuid())
  name        String
  username    String       @unique
  team        String?      // Time do coraÃ§Ã£o
  points      Int          @default(0)
  isPremium   Boolean      @default(false)
  predictions Prediction[]
}

model Rumor {
  id          String       @id @default(cuid())
  playerName  String
  fromTeam    String?
  toTeam      String
  title       String
  description String?
  category    String       @default("transferencia")
  sentiment   Float        @default(0.5)
  status      String       @default("open")
  closesAt    DateTime
  signalScore Float?       @default(0)
  predictions Prediction[]
  signals     Signal[]
  newsItems   RumorNewsItem[]
}

model Prediction {
  id         String   @id @default(cuid())
  rumorId    String
  userId     String
  prediction Boolean
}

model NewsItem {
  id           String   @id @default(cuid())
  source       String   // "twitter" | "youtube" | "globo" | "uol"
  content      String
  publishedAt  DateTime
  rumors       RumorNewsItem[]
}
```

---

## APIs

### GET /api/rumors
Retorna rumores com ordenaÃ§Ã£o por relevÃ¢ncia.

**Query params**:
- `limit` - Quantidade (default: 10)
- `offset` - PaginaÃ§Ã£o
- `order` - "quentes" | "recentes" | "fechando"
- `userId` - ID do usuÃ¡rio (para personalizaÃ§Ã£o)
- `userTeam` - Time do usuÃ¡rio

### GET /api/rumors/relevance
Endpoint dedicado para feed personalizado.

### POST /api/reactions
Registra reaÃ§Ã£o do usuÃ¡rio.

**Body**:
```json
{
  "rumorId": "string",
  "userId": "string",
  "reaction": "ğŸ”¥" | "ğŸ‘" | "ğŸ˜" | "ğŸ˜•" | "ğŸ’”"
}
```

---

## Design System

### Cores

```typescript
const COLORS = {
  bgPrimary: '#09090B',
  bgSecondary: '#18181B',
  textPrimary: '#FAFAFA',
  textMuted: '#71717A',
  accentGreen: '#10B981',
  colorVai: '#10B981',
  colorNao: '#EF4444',
  colorQuente: '#F97316',
}
```

### Categorias de Rumor

```typescript
const CATEGORY_LABELS = {
  transferencia: { label: 'TransferÃªncia', emoji: 'âš½', color: '#ff1744' },
  tecnico: { label: 'TÃ©cnico', emoji: 'ğŸ“‹', color: '#ffd700' },
  titulo: { label: 'TÃ­tulo', emoji: 'ğŸ†', color: '#00f5a0' },
  selecao: { label: 'SeleÃ§Ã£o', emoji: 'ğŸ‡§ğŸ‡·', color: '#00d9f5' },
}
```

---

## Stack TÃ©cnico

- **Framework**: Next.js 16 (App Router)
- **Database**: PostgreSQL (via Prisma)
- **Styling**: CSS-in-JS (inline styles)
- **Fontes**: Space Grotesk, JetBrains Mono
- **Escudos**: SofaScore API

---

## PrÃ³ximos Passos Sugeridos

1. **AutenticaÃ§Ã£o real** - Substituir usuÃ¡rio demo
2. **Scraping de notÃ­cias** - Automatizar coleta de Twitter/YouTube/Globo
3. **Sistema de notificaÃ§Ãµes** - Push notifications para rumores quentes
4. **GamificaÃ§Ã£o** - Badges e ranking de acertos
5. **Premium** - Liberar todos os times para assinantes

---

## Changelog

### 30/01/2025
- âœ… Sistema de reaÃ§Ãµes Slack-style
- âœ… PÃ¡gina de detalhes do rumor com tabs
- âœ… ValidaÃ§Ã£o de fontes (aviso se nÃ£o houver news/tweets)
- âœ… Escudos reais dos times (SofaScore API)
- âœ… Algoritmo de relevÃ¢ncia para feed
- âœ… OrdenaÃ§Ã£o por: Meu Time > Engajamento > Buzz > RecÃªncia > UrgÃªncia
